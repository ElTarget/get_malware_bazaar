import os
import pefile

cur_py_path, _ = os.path.split(os.path.abspath(__file__))
pefile_path = 'pycharm64.exe'
file_path = os.path.join(cur_py_path, pefile_path)
pe_obj = pefile.PE(pefile_path)


def fuckHash(hash1, hash2):
    icount = 0.00
    for i in hash1:
        if i in hash2:
            icount += 1
    return float(icount * 2 / (len(hash1) + len(hash2)))


if __name__ == '__main__':
    print(fuckHash(pe_obj.get_imphash(), pe_obj.get_rich_header_hash(algorithm="sha256")))
