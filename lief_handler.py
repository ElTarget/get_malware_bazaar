import hashlib
import os

import lief

cur_py_path, _ = os.path.split(os.path.abspath(__file__))
pefile_path = 'pycharm64.exe'
pe = lief.parse(pefile_path)
print(len(pe.signatures))

signature = pe.signatures[0]
for crt in signature.certificates:
    print(crt)
print(signature.content_info.digest)
print(pe.authentihash(lief.PE.ALGORITHMS.SHA_256))
print(getattr(hashlib, 'sha256')(pe.authentihash(lief.PE.ALGORITHMS.SHA_256)).digest())
print(getattr(hashlib, 'sha256')(pe.authentihash(lief.PE.ALGORITHMS.SHA_256)).hexdigest())
# Print signer information
print(signature.signers[0])
print(pe.verify_signature())

with open(pefile_path, 'rb') as f:
    print(hashlib.sha256(f.read()).hexdigest())
